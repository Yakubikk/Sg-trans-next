# CRUD для деталей железнодорожных цистерн

## Обзор

Реализован полный CRUD (Create, Read, Update, Delete) для управления деталями железнодорожных цистерн с поддержкой различных типов деталей и их специфичных полей.

## Компоненты

### Backend (ASP.NET Core)

**Файл**: `backend/WebApp/Endpoints/RailwayCisterns/PartsEndpoints.cs`

#### Эндпоинты:

1. **GET /api/parts** - Получение списка деталей с пагинацией и фильтрацией
2. **GET /api/parts/{id}** - Получение детали по ID
3. **POST /api/parts/wheel-pairs** - Создание колесной пары
4. **POST /api/parts/side-frames** - Создание боковой рамы
5. **POST /api/parts/bolsters** - Создание надрессорной балки
6. **POST /api/parts/couplers** - Создание автосцепки
7. **POST /api/parts/shock-absorbers** - Создание поглощающего аппарата
8. **PUT /api/parts/wheel-pairs/{id}** - Обновление колесной пары
9. **PUT /api/parts/side-frames/{id}** - Обновление боковой рамы
10. **PUT /api/parts/bolsters/{id}** - Обновление надрессорной балки
11. **PUT /api/parts/couplers/{id}** - Обновление автосцепки
12. **PUT /api/parts/shock-absorbers/{id}** - Обновление поглощающего аппарата
13. **DELETE /api/parts/{id}** - Удаление детали

### Frontend (Next.js + React)

#### Основные файлы:

1. **`src/app/(dashboard)/directories/parts/page.tsx`** - Главная страница со списком деталей
2. **`src/components/parts/part-create-dialog.tsx`** - Диалог создания новой детали
3. **`src/components/parts/part-edit-dialog.tsx`** - Диалог редактирования детали

#### API слой:

- **`src/api/directories.ts`** - API функции для работы с деталями
- **`src/hooks/useDirectories.ts`** - React Query хуки для CRUD операций
- **`src/types/directories.ts`** - TypeScript типы для деталей

## Поддерживаемые типы деталей

### 1. Колесная пара (код: 1)
**Специфичные поля:**
- Толщина левого колеса
- Толщина правого колеса  
- Тип колеса

### 2. Надрессорная балка (код: 2)
**Специфичные поля:**
- Срок службы (лет)
- Продлен до (дата)

### 3. Боковая рама (код: 3)
**Специфичные поля:**
- Срок службы (лет)
- Продлен до (дата)

### 4. Автосцепка (код: 4)
**Специфичные поля:**
- Только базовые поля

### 5. Поглощающий аппарат (код: 10)
**Специфичные поля:**
- Модель
- Код производителя
- Дата следующего ремонта
- Срок службы (лет)

## Общие поля для всех деталей

- **Тип детали** (обязательное)
- **Номер клейма** (обязательное)
- **Статус** (обязательное)
- Серийный номер
- Год производства
- Депо
- Текущее местоположение
- Примечания

## Функциональность

### Создание деталей
- Динамическая форма, которая адаптируется в зависимости от выбранного типа детали
- Валидация полей с использованием Zod
- Отображение специфичных полей для каждого типа детали

### Просмотр деталей
- Таблица с пагинацией
- Поиск по серийному номеру, типу, клейму и местоположению
- Фильтрация по типу детали
- Отображение специфичной информации в зависимости от типа детали

### Редактирование деталей
- Предзаполненная форма с текущими данными
- Тип детали отображается только для просмотра (не редактируется)
- Динамические поля в зависимости от типа детали

### Удаление деталей
- Подтверждение перед удалением
- Уведомления об успешном/неуспешном выполнении операций

## Технические особенности

### Валидация
- Клиентская валидация с помощью Zod
- Серверная валидация через Data Annotations

### Обработка ошибок
- Toast уведомления для пользователя
- Логирование ошибок в консоль

### Типизация
- Полная типизация TypeScript
- Отдельные DTO для создания и обновления каждого типа детали

### State Management
- React Query для кэширования и синхронизации данных
- Автоматическое обновление списка после CRUD операций

## Использование

1. **Создание детали**: Нажать кнопку "Добавить деталь", выбрать тип и заполнить форму
2. **Просмотр**: Список отображается автоматически с возможностью поиска и фильтрации
3. **Редактирование**: Нажать кнопку с иконкой карандаша в строке детали
4. **Удаление**: Нажать кнопку с иконкой корзины и подтвердить действие

## Расширение функциональности

Для добавления нового типа детали необходимо:

1. **Backend**: Добавить новые эндпоинты в `PartsEndpoints.cs`
2. **Frontend**: 
   - Добавить новые DTO типы в `types/directories.ts`
   - Обновить API функции в `api/directories.ts`
   - Добавить новые хуки в `hooks/useDirectories.ts`
   - Обновить формы создания и редактирования для поддержки нового типа
